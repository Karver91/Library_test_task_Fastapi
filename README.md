# Library_test_task
Тестовое задание: Веб-приложение на Fastapi по управлению библиотекой. 

Сервис представляет собой систему управления библиотекой, которая обеспечивает функциональность для работы с книгами 
и читателями, а также процессами выдачи и возврата книг. Система реализована с использованием JWT для 
аутентификации и защиты данных.

### Структура
```
    project-backend
    ├── app/
    │   ├── auth/
    │   │   ├── models.py       # Модели бд
    │   │   ├── repository.py   # Методы для работы с бд
    │   │   ├── routes.py       # Роутеры/Ручки/Эндпоинты
    │   │   ├── schemas.py      # Модели валидации pydantic
    │   │   ├── service.py      # Бизнес-логика
    │   │   └── utils.py
    │   ├── migrations/         # Миграции alembic
    │   ├── modules/            # Модули/Сущности
    │   │   ├── book/
    │   │   ├── borrowing/
    │   │   ├── reader/
    │   ├── utils/
    │   │   ├── repository.py   # Базовый класс репозитрия
    │   │   ├── schemas.py      # Базовая схема ответа
    │   ├── config.py
    │   ├── db.py               # engine, session, базовый класс моделей
    │   ├── dependencies.py               
    │   ├── enums.py         
    │   ├── routes.py           # Регистрация всех системных роутеров
    │   └── main.py
    ├── tests/
    ├── .env
    ├── .gitignore
    ├── test.env                # Хранит переменные окружения для тестовой базы
    └── alembic.ini
```
### Стэк
- Fastapi, 
- SQLAlchemy, 
- PostgreSQL, 
- Alembic, 
- Docker

### Для запуска приложения:
#### Локально
- Создать **.env** с переменными окружения, указанными в **.env.example**
- Создать базу данных
- Запустить миграции с помощью `alembic upgrade head`
- Запустить uvicorn `uvicorn app.main:app`
- Открыть свагер на порту `8000`
#### Docker
- Создать **.env** с переменными окружения, указанными в **.env.example**
- Запустить `docker compose up --build` для сборки и развертывания приложения
- Открыть свагер на порту `9999`

### Тестирование:
- Тесты используют параметры для базы данных из файла **test.env**. Соответственно, 
- название базы данных, имя пользователя и пароль берутся от туда

### Творческая часть
Можно включит в проект автоматическую отправку email-напоминаний о просроченных книгах.
Нечто подобное я делал 
[для телеграм бота](https://github.com/Karver91/massage_scheduler_bot/blob/master/database/backup/backup.py), 
только там отправлялся CSV-файл

- Нужно добавить планировщик задач (Celery) и библиотеку для работы с SMTP (aiosmtplib)
- Добавить новое поле в таблицу `borrowed`, отвечающее за время, на которое читатель взял книгу
- Добавить задачу для Celery для ежедневной проверки просрочек
- Автоматическая отправка уведомлений с требованием вернуть книгу
